log_format operation escape=none 'secretdev1 {
    "date": "$time_iso8601",
    "duration": $request_time,
    "status": {"code": $status},
    "owner": $upstream_http_x_owner,
    "host": "$host",
    "id_token": "$cookie_id_token.$cookie_id_token_sign",
    "id_token_org": "$cookie_id_token_org",
    "apiKey": "$http_x_apikey",
    "account": "http_x_account",
    "processing": "http_x_processing",
    "cacheStatus": "$upstream_cache_status",
    "resource": $upstream_http_x_resource,
    "operation": $upstream_http_x_operation,
    "referer": "$http_referer",
    "bytes": $bytes_sent
}';

server {
    listen 6202;
    server_name localhost;

    location / {
        access_log syslog:server=localhost:51432 operation if=$upstream_http_x_operation;
        proxy_pass http://localhost:6203;
        proxy_set_header Host $http_host;
    	proxy_cache_bypass $http_upgrade;
    }
}
